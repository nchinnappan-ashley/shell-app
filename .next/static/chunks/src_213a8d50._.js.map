{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/NChinnappan/SourceAI/UI/shell-app/src/components/layout/Sidebar.tsx"],"sourcesContent":["'use client';\n\nimport React from 'react';\nimport { useRouter } from 'next/navigation';\nimport {\n  HomeIcon,\n  BuildingOfficeIcon,\n  TruckIcon,\n  CurrencyDollarIcon,\n  UserGroupIcon,\n  DocumentTextIcon,\n  CubeIcon,\n  ServerIcon,\n  PlusIcon,\n  Squares2X2Icon\n} from '@heroicons/react/24/outline';\nimport clsx from 'clsx';\n\ninterface Department {\n  id: string;\n  name: string;\n  icon: React.ComponentType<{ className?: string }>;\n  color: string;\n}\n\nconst departments: Department[] = [\n  { id: 'ashleydirect', name: 'Ashley Direct', icon: Squares2X2Icon, color: 'bg-blue-500' },\n  { id: 'ashleynet', name: 'Ashley Net', icon: BuildingOfficeIcon, color: 'bg-green-500' },\n  { id: 'supplier', name: 'Supplier', icon: TruckIcon, color: 'bg-purple-500' },\n  { id: 'finance', name: 'Finance', icon: CurrencyDollarIcon, color: 'bg-yellow-500' },\n  { id: 'hr', name: 'HR', icon: UserGroupIcon, color: 'bg-pink-500' },\n  { id: 'payroll', name: 'Payroll', icon: DocumentTextIcon, color: 'bg-indigo-500' },\n  { id: 'transportation', name: 'Transportation', icon: TruckIcon, color: 'bg-orange-500' },\n  { id: 'highjump', name: 'HighJump', icon: CubeIcon, color: 'bg-teal-500' },\n  { id: 'as400', name: 'AS400', icon: ServerIcon, color: 'bg-red-500' },\n];\n\ninterface SidebarProps {\n  selectedDepartment: string | null;\n  onDepartmentSelect: (department: string | null) => void;\n  onPlusClick?: () => void;\n}\n\nexport function Sidebar({ selectedDepartment, onDepartmentSelect, onPlusClick }: SidebarProps) {\n  const router = useRouter();\n  return (\n    <div className=\"w-16 bg-white border-r border-gray-200 flex flex-col items-center py-4 space-y-4\">\n      {/* Logo/Home */}\n      <button\n        onClick={() => { onDepartmentSelect(null); router.push('/'); }}\n        className={clsx(\n          'w-10 h-10 rounded-lg flex items-center justify-center transition-colors',\n          selectedDepartment === null \n            ? 'bg-gray-900 text-white' \n            : 'bg-gray-100 text-gray-600 hover:bg-gray-200'\n        )}\n      >\n        <HomeIcon className=\"w-5 h-5\" />\n      </button>\n\n      {/* Add New (opens recent searches) */}\n      <button\n        onClick={() => onPlusClick?.()}\n        aria-label=\"Open recent searches\"\n        className=\"w-10 h-10 rounded-lg bg-gray-100 text-gray-400 hover:bg-gray-200 hover:text-gray-600 flex items-center justify-center transition-colors\"\n      >\n        <PlusIcon className=\"w-5 h-5\" />\n      </button>\n\n      {/* Departments */}\n      <div className=\"flex flex-col space-y-3\">\n        {departments.map((dept) => {\n          const IconComponent = dept.icon;\n          return (\n            <button\n              key={dept.id}\n              onClick={() => { onDepartmentSelect(dept.id); router.push(`/apps/${dept.id}`); }}\n              className={clsx(\n                'w-10 h-10 rounded-lg flex items-center justify-center transition-colors',\n                selectedDepartment === dept.id\n                  ? `${dept.color} text-white`\n                  : 'bg-gray-100 text-gray-600 hover:bg-gray-200'\n              )}\n              title={dept.name}\n            >\n              <IconComponent className=\"w-5 h-5\" />\n            </button>\n          );\n        })}\n      </div>\n\n      {/* User Profile */}\n      <div className=\"mt-auto\">\n        <div className=\"w-10 h-10 rounded-full bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center text-white font-medium text-sm\">\n          U\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AAGA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAYA;;;AAhBA;;;;AAyBA,MAAM,cAA4B;IAChC;QAAE,IAAI;QAAgB,MAAM;QAAiB,MAAM,gPAAc;QAAE,OAAO;IAAc;IACxF;QAAE,IAAI;QAAa,MAAM;QAAc,MAAM,4PAAkB;QAAE,OAAO;IAAe;IACvF;QAAE,IAAI;QAAY,MAAM;QAAY,MAAM,iOAAS;QAAE,OAAO;IAAgB;IAC5E;QAAE,IAAI;QAAW,MAAM;QAAW,MAAM,4PAAkB;QAAE,OAAO;IAAgB;IACnF;QAAE,IAAI;QAAM,MAAM;QAAM,MAAM,6OAAa;QAAE,OAAO;IAAc;IAClE;QAAE,IAAI;QAAW,MAAM;QAAW,MAAM,sPAAgB;QAAE,OAAO;IAAgB;IACjF;QAAE,IAAI;QAAkB,MAAM;QAAkB,MAAM,iOAAS;QAAE,OAAO;IAAgB;IACxF;QAAE,IAAI;QAAY,MAAM;QAAY,MAAM,8NAAQ;QAAE,OAAO;IAAc;IACzE;QAAE,IAAI;QAAS,MAAM;QAAS,MAAM,oOAAU;QAAE,OAAO;IAAa;CACrE;AAQM,SAAS,QAAQ,KAAqE;QAArE,EAAE,kBAAkB,EAAE,kBAAkB,EAAE,WAAW,EAAgB,GAArE;;IACtB,MAAM,SAAS,IAAA,kJAAS;IACxB,qBACE,6LAAC;QAAI,WAAU;;0BAEb,6LAAC;gBACC,SAAS;oBAAQ,mBAAmB;oBAAO,OAAO,IAAI,CAAC;gBAAM;gBAC7D,WAAW,IAAA,mJAAI,EACb,2EACA,uBAAuB,OACnB,2BACA;0BAGN,cAAA,6LAAC,8NAAQ;oBAAC,WAAU;;;;;;;;;;;0BAItB,6LAAC;gBACC,SAAS,IAAM,wBAAA,kCAAA;gBACf,cAAW;gBACX,WAAU;0BAEV,cAAA,6LAAC,8NAAQ;oBAAC,WAAU;;;;;;;;;;;0BAItB,6LAAC;gBAAI,WAAU;0BACZ,YAAY,GAAG,CAAC,CAAC;oBAChB,MAAM,gBAAgB,KAAK,IAAI;oBAC/B,qBACE,6LAAC;wBAEC,SAAS;4BAAQ,mBAAmB,KAAK,EAAE;4BAAG,OAAO,IAAI,CAAC,AAAC,SAAgB,OAAR,KAAK,EAAE;wBAAK;wBAC/E,WAAW,IAAA,mJAAI,EACb,2EACA,uBAAuB,KAAK,EAAE,GAC1B,AAAC,GAAa,OAAX,KAAK,KAAK,EAAC,iBACd;wBAEN,OAAO,KAAK,IAAI;kCAEhB,cAAA,6LAAC;4BAAc,WAAU;;;;;;uBAVpB,KAAK,EAAE;;;;;gBAalB;;;;;;0BAIF,6LAAC;gBAAI,WAAU;0BACb,cAAA,6LAAC;oBAAI,WAAU;8BAAuI;;;;;;;;;;;;;;;;;AAM9J;GAxDgB;;QACC,kJAAS;;;KADV","debugId":null}},
    {"offset": {"line": 190, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/NChinnappan/SourceAI/UI/shell-app/src/components/theme/ThemeToggle.tsx"],"sourcesContent":["\"use client\";\n\nimport React, { useEffect, useMemo, useState } from \"react\";\nimport { SunIcon, MoonIcon, ComputerDesktopIcon } from \"@heroicons/react/24/outline\";\n\n// Simple theme manager that toggles between light, dark, and system.\n// Applies the theme by setting document.documentElement.dataset.theme\n// and persists choice in localStorage under key \"theme\".\n\ntype Theme = \"light\" | \"dark\" | \"system\";\n\nfunction getSystemTheme(): \"light\" | \"dark\" {\n  if (typeof window === \"undefined\") return \"light\";\n  return window.matchMedia && window.matchMedia(\"(prefers-color-scheme: dark)\").matches\n    ? \"dark\"\n    : \"light\";\n}\n\nfunction applyTheme(theme: Theme) {\n  if (typeof document === \"undefined\") return;\n  const root = document.documentElement;\n  if (theme === \"system\") {\n    root.removeAttribute(\"data-theme\");\n    // Let system take over; set color-scheme to current system for better native UI\n    const cs = getSystemTheme();\n    root.style.colorScheme = cs;\n  } else {\n    root.setAttribute(\"data-theme\", theme);\n    root.style.colorScheme = theme;\n  }\n}\n\n// Brand color selection\ntype Color = \"blue\" | \"emerald\" | \"violet\";\n\nfunction applyColor(color: Color) {\n  if (typeof document === \"undefined\") return;\n  const root = document.documentElement;\n  root.setAttribute(\"data-color\", color);\n}\n\n\nexport function ThemeToggle() {\n  const [theme, setTheme] = useState<Theme>(\"system\");\n  const [color, setColor] = useState<Color>(\"blue\");\n\n  const [open, setOpen] = useState(false);\n  const rootRef = React.useRef<HTMLDivElement | null>(null);\n  const [mounted, setMounted] = useState(false);\n\n  // On mount, read stored preference and apply\n  useEffect(() => {\n    try {\n      const storedTheme = (localStorage.getItem(\"theme\") as Theme | null) ?? \"system\";\n      const storedColor = (localStorage.getItem(\"color\") as Color | null) ?? \"blue\";\n      setTheme(storedTheme);\n      setColor(storedColor);\n      applyTheme(storedTheme);\n      applyColor(storedColor);\n    } catch {\n      // ignore\n    }\n  }, []);\n\n  // mark mounted to avoid SSR/CSR mismatch\n  useEffect(() => { setMounted(true); }, []);\n\n  // If user chooses system, reflect live system changes in the icon after mount\n  const systemTheme = useMemo(() => (typeof window !== \"undefined\" ? getSystemTheme() : \"light\"), []);\n  useEffect(() => {\n    if (!mounted) return;\n    if (theme !== \"system\" || typeof window === \"undefined\") return;\n    const mq = window.matchMedia(\"(prefers-color-scheme: dark)\");\n    const onChange = () => applyTheme(\"system\");\n    mq.addEventListener?.('change', onChange);\n    return () => mq.removeEventListener?.('change', onChange);\n  }, [theme, mounted]);\n\n  // Close popover when clicking outside\n  useEffect(() => {\n    const onDown = (e: MouseEvent) => {\n      if (!rootRef.current) return;\n      if (!rootRef.current.contains(e.target as Node)) setOpen(false);\n    };\n    document.addEventListener('mousedown', onDown);\n    return () => document.removeEventListener('mousedown', onDown);\n  }, []);\n\n\n  const shown: \"light\" | \"dark\" = mounted ? (theme === \"system\" ? getSystemTheme() : theme) : \"light\";\n\n  const cycle = () => {\n    const next: Theme = theme === \"light\" ? \"dark\" : theme === \"dark\" ? \"system\" : \"light\";\n    setTheme(next);\n    try {\n      localStorage.setItem(\"theme\", next);\n    } catch {}\n    applyTheme(next);\n  };\n\n  const Icon = shown === \"dark\" ? MoonIcon : shown === \"light\" ? SunIcon : ComputerDesktopIcon;\n  const label = theme === \"system\" ? `System (${shown})` : shown === \"dark\" ? \"Dark\" : \"Light\";\n\n  const choose = (c: Color) => {\n    setColor(c);\n    try { localStorage.setItem(\"color\", c); } catch {}\n    applyColor(c);\n  };\n\n  return (\n    <div ref={rootRef} className=\"relative\">\n      <button\n        type=\"button\"\n        aria-label={`Theme: ${label} (click to open color picker)`}\n        title={`Theme: ${label}`}\n        onClick={() => setOpen((v) => !v)}\n        className=\"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors\"\n      >\n        <Icon className=\"w-5 h-5\" />\n      </button>\n      {open && (\n        <div className=\"absolute right-0 top-10 z-50 bg-white/95 dark:bg-slate-900/95 border border-gray-200/70 dark:border-gray-700/60 rounded-lg shadow-lg p-2 flex items-center gap-2 backdrop-blur-sm\">\n          <button\n            type=\"button\"\n            onClick={() => { choose('blue'); setOpen(false); }}\n            aria-label=\"Blue theme\"\n            className={`h-6 w-6 rounded-full ring-2 ring-offset-1 ${color === 'blue' ? 'ring-gray-400' : 'ring-transparent'}`}\n            style={{ backgroundColor: '#3b82f6' }}\n          />\n          <button\n            type=\"button\"\n            onClick={() => { choose('emerald'); setOpen(false); }}\n            aria-label=\"Emerald theme\"\n            className={`h-6 w-6 rounded-full ring-2 ring-offset-1 ${color === 'emerald' ? 'ring-gray-400' : 'ring-transparent'}`}\n            style={{ backgroundColor: '#10b981' }}\n          />\n          <button\n            type=\"button\"\n            onClick={() => { choose('violet'); setOpen(false); }}\n            aria-label=\"Violet theme\"\n            className={`h-6 w-6 rounded-full ring-2 ring-offset-1 ${color === 'violet' ? 'ring-gray-400' : 'ring-transparent'}`}\n            style={{ backgroundColor: '#8b5cf6' }}\n          />\n        </div>\n      )}\n    </div>\n  );\n}\n\nexport default ThemeToggle;\n\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 415, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/NChinnappan/SourceAI/UI/shell-app/src/components/layout/Header.tsx"],"sourcesContent":["'use client';\n\nimport React from 'react';\nimport Image from 'next/image';\nimport {\n  MagnifyingGlassIcon,\n  BellIcon,\n  Cog6ToothIcon\n} from '@heroicons/react/24/outline';\nimport { ThemeToggle } from '../theme/ThemeToggle';\n\nexport function Header() {\n  return (\n    <header className=\"h-16 bg-white border-b border-gray-200 flex items-center justify-between px-6\">\n      {/* Search Bar */}\n      <div className=\"flex-1 max-w-2xl\">\n        <div className=\"relative\">\n          <MagnifyingGlassIcon className=\"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400\" />\n          <input\n            type=\"text\"\n            placeholder=\"Ask anything, create anything\"\n            className=\"w-full pl-10 pr-4 py-2 text-gray-900 placeholder-gray-500 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--ring)] focus:border-transparent\"\n          />\n        </div>\n      </div>\n\n      {/* Right Side Actions */}\n      <div className=\"flex items-center space-x-4\">\n        {/* Notifications */}\n        <button className=\"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors\">\n          <BellIcon className=\"w-5 h-5\" />\n        </button>\n\n        {/* Theme */}\n        <ThemeToggle />\n\n        {/* Settings */}\n        <button className=\"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors\">\n          <Cog6ToothIcon className=\"w-5 h-5\" />\n        </button>\n\n        {/* Ashley logo icon */}\n        <div className=\"h-8 w-auto flex items-center\">\n          <Image\n            src=\"/AshleyLogoLLCOrangeBlack.png\"\n            alt=\"Ashley\"\n            width={104}\n            height={32}\n            priority\n          />\n        </div>\n      </div>\n    </header>\n  );\n}\n"],"names":[],"mappings":";;;;;AAGA;AACA;AAAA;AAAA;AAKA;AATA;;;;;AAWO,SAAS;IACd,qBACE,6LAAC;QAAO,WAAU;;0BAEhB,6LAAC;gBAAI,WAAU;0BACb,cAAA,6LAAC;oBAAI,WAAU;;sCACb,6LAAC,+PAAmB;4BAAC,WAAU;;;;;;sCAC/B,6LAAC;4BACC,MAAK;4BACL,aAAY;4BACZ,WAAU;;;;;;;;;;;;;;;;;0BAMhB,6LAAC;gBAAI,WAAU;;kCAEb,6LAAC;wBAAO,WAAU;kCAChB,cAAA,6LAAC,8NAAQ;4BAAC,WAAU;;;;;;;;;;;kCAItB,6LAAC,4JAAW;;;;;kCAGZ,6LAAC;wBAAO,WAAU;kCAChB,cAAA,6LAAC,6OAAa;4BAAC,WAAU;;;;;;;;;;;kCAI3B,6LAAC;wBAAI,WAAU;kCACb,cAAA,6LAAC,2IAAK;4BACJ,KAAI;4BACJ,KAAI;4BACJ,OAAO;4BACP,QAAQ;4BACR,QAAQ;;;;;;;;;;;;;;;;;;;;;;;AAMpB;KA3CgB","debugId":null}},
    {"offset": {"line": 546, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/NChinnappan/SourceAI/UI/shell-app/src/utils/searchHistory.ts"],"sourcesContent":["\"use client\";\n\n// Simple localStorage-backed search history tracker\n// Stores up to 10 entries, most recent first. Dedupes by app id (or query if id missing).\n\nexport type SearchHistoryItem = {\n  id?: string;         // app id if known\n  title?: string;      // app title if known\n  query: string;       // raw query typed/spoken\n  path?: string;       // navigation path to execute (e.g. /apps/{id})\n  ts: number;          // timestamp ms\n  count: number;       // times used\n};\n\nconst STORAGE_KEY = \"search_history_v1\";\n\nexport function readHistory(): SearchHistoryItem[] {\n  if (typeof window === \"undefined\") return [];\n  try {\n    const raw = localStorage.getItem(STORAGE_KEY);\n    if (!raw) return [];\n    const arr = JSON.parse(raw) as SearchHistoryItem[];\n    if (!Array.isArray(arr)) return [];\n    return arr;\n  } catch {\n    return [];\n  }\n}\n\nfunction writeHistory(items: SearchHistoryItem[]) {\n  if (typeof window === \"undefined\") return;\n  try {\n    localStorage.setItem(STORAGE_KEY, JSON.stringify(items.slice(0, 10)));\n  } catch {\n    // ignore\n  }\n}\n\nexport function recordSearch(entry: Omit<SearchHistoryItem, \"ts\" | \"count\">) {\n  const prev = readHistory();\n  const ts = Date.now();\n  // Try to match by id first, else by query\n  const idx = prev.findIndex((it) => (entry.id && it.id === entry.id) || (!entry.id && it.query.toLowerCase() === entry.query.toLowerCase()));\n  if (idx >= 0) {\n    const existing = prev[idx];\n    const updated: SearchHistoryItem = {\n      ...existing,\n      ...entry,\n      ts,\n      count: (existing.count || 0) + 1,\n    };\n    const reordered = [updated, ...prev.filter((_, i) => i !== idx)];\n    writeHistory(reordered);\n    return;\n  }\n  const next: SearchHistoryItem = { ...entry, ts, count: 1 };\n  const list = [next, ...prev].sort((a, b) => b.ts - a.ts).slice(0, 10);\n  writeHistory(list);\n}\n\nexport function clearHistory() {\n  writeHistory([]);\n}\n\n"],"names":[],"mappings":";;;;;;;;AAAA;AAcA,MAAM,cAAc;AAEb,SAAS;IACd;;IACA,IAAI;QACF,MAAM,MAAM,aAAa,OAAO,CAAC;QACjC,IAAI,CAAC,KAAK,OAAO,EAAE;QACnB,MAAM,MAAM,KAAK,KAAK,CAAC;QACvB,IAAI,CAAC,MAAM,OAAO,CAAC,MAAM,OAAO,EAAE;QAClC,OAAO;IACT,EAAE,UAAM;QACN,OAAO,EAAE;IACX;AACF;AAEA,SAAS,aAAa,KAA0B;IAC9C;;IACA,IAAI;QACF,aAAa,OAAO,CAAC,aAAa,KAAK,SAAS,CAAC,MAAM,KAAK,CAAC,GAAG;IAClE,EAAE,UAAM;IACN,SAAS;IACX;AACF;AAEO,SAAS,aAAa,KAA8C;IACzE,MAAM,OAAO;IACb,MAAM,KAAK,KAAK,GAAG;IACnB,0CAA0C;IAC1C,MAAM,MAAM,KAAK,SAAS,CAAC,CAAC,KAAO,AAAC,MAAM,EAAE,IAAI,GAAG,EAAE,KAAK,MAAM,EAAE,IAAM,CAAC,MAAM,EAAE,IAAI,GAAG,KAAK,CAAC,WAAW,OAAO,MAAM,KAAK,CAAC,WAAW;IACvI,IAAI,OAAO,GAAG;QACZ,MAAM,WAAW,IAAI,CAAC,IAAI;QAC1B,MAAM,UAA6B;YACjC,GAAG,QAAQ;YACX,GAAG,KAAK;YACR;YACA,OAAO,CAAC,SAAS,KAAK,IAAI,CAAC,IAAI;QACjC;QACA,MAAM,YAAY;YAAC;eAAY,KAAK,MAAM,CAAC,CAAC,GAAG,IAAM,MAAM;SAAK;QAChE,aAAa;QACb;IACF;IACA,MAAM,OAA0B;QAAE,GAAG,KAAK;QAAE;QAAI,OAAO;IAAE;IACzD,MAAM,OAAO;QAAC;WAAS;KAAK,CAAC,IAAI,CAAC,CAAC,GAAG,IAAM,EAAE,EAAE,GAAG,EAAE,EAAE,EAAE,KAAK,CAAC,GAAG;IAClE,aAAa;AACf;AAEO,SAAS;IACd,aAAa,EAAE;AACjB","debugId":null}},
    {"offset": {"line": 622, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/NChinnappan/SourceAI/UI/shell-app/src/components/layout/MainContent.tsx"],"sourcesContent":["'use client';\n\nimport React, { useMemo, useState } from 'react';\nimport { useRouter } from 'next/navigation';\nimport catalogData from '@/data/catalog.json';\nimport { recordSearch } from '@/utils/searchHistory';\nimport dynamic from 'next/dynamic';\nconst ForYouFeather = dynamic(() => import('./ForYouFeather'), { ssr: false });\nimport {\n  PresentationChartLineIcon,\n  TableCellsIcon,\n  ChatBubbleLeftRightIcon,\n  DocumentTextIcon,\n  ChartBarIcon,\n  CodeBracketIcon,\n  PhotoIcon,\n  VideoCameraIcon,\n  MicrophoneIcon,\n  SparklesIcon\n} from '@heroicons/react/24/outline';\n\nimport aiAgentsData from '@/data/ai-agents.json';\n\ntype IconKey =\n  | 'PresentationChartLineIcon'\n  | 'TableCellsIcon'\n  | 'ChatBubbleLeftRightIcon'\n  | 'DocumentTextIcon'\n  | 'ChartBarIcon'\n  | 'CodeBracketIcon'\n  | 'PhotoIcon'\n  | 'VideoCameraIcon'\n  | 'MicrophoneIcon'\n  | 'SparklesIcon';\n\nconst ICONS = {\n  PresentationChartLineIcon,\n  TableCellsIcon,\n  ChatBubbleLeftRightIcon,\n  DocumentTextIcon,\n  ChartBarIcon,\n  CodeBracketIcon,\n  PhotoIcon,\n  VideoCameraIcon,\n  MicrophoneIcon,\n  SparklesIcon,\n};\n\ninterface AIAgent {\n  id: string;\n  name: string;\n  description: string;\n  icon: React.ComponentType<{ className?: string }>;\n  isNew?: boolean;\n  isHot?: boolean;\n}\n\ntype AIAgentJson = {\n  id: string;\n  name: string;\n  description: string;\n  icon: IconKey;\n  isNew?: boolean;\n  isHot?: boolean;\n};\n\nconst aiAgents: AIAgent[] = (aiAgentsData as AIAgentJson[]).map((a) => ({\n  id: a.id,\n  name: a.name,\n  description: a.description,\n  icon: ICONS[a.icon] || SparklesIcon,\n  isNew: a.isNew,\n  isHot: a.isHot,\n}));\n\nconst SHOW_AI_GRID = false; // center grid hidden per request\n\n\nexport function MainContent() {\n  const router = useRouter();\n  type AppEntry = { id: string; title: string };\n  const apps = catalogData as unknown as AppEntry[];\n  const [query, setQuery] = useState('');\n  const [active, setActive] = useState(0);\n  const [listening, setListening] = useState(false);\n\n  const normalize = (s: string) => s.toLowerCase().replace(/[^a-z0-9 ]/g, ' ').replace(/\\s+/g, ' ').trim();\n  const findBestApp = (input: string): AppEntry | undefined => {\n    const q = normalize(input);\n    if (!q) return undefined;\n    let best: { score: number; app: AppEntry } | undefined;\n    for (const a of apps) {\n      const t = normalize(a.title);\n      let score = 0;\n      if (t === q) score = 100;\n      else if (t.startsWith(q) || q.startsWith(t)) score = 80;\n      else if (t.includes(q) || q.includes(t)) score = 60;\n      else {\n        const qt = new Set(q.split(' '));\n        const tt = new Set(t.split(' '));\n        let overlap = 0;\n        qt.forEach(w => { if (tt.has(w)) overlap++; });\n        if (overlap > 0) score = 40 + overlap;\n      }\n      if (!best || score > best.score) best = { score, app: a };\n    }\n    if (best && best.score >= 60) return best.app;\n    return undefined;\n  };\n\n  const filtered = useMemo(() => {\n    const q = query.trim().toLowerCase();\n    if (!q) return [] as AppEntry[];\n    return apps.filter(a => a.title.toLowerCase().includes(q)).slice(0, 7);\n  }, [apps, query]);\n  const go = (id: string) => {\n    const app = apps.find(a => a.id === id);\n    const path = `/apps/${id}`;\n    recordSearch({ id, title: app?.title, query: (query || app?.title || '').trim(), path });\n    router.push(path);\n  };\n  const onKeyDown: React.KeyboardEventHandler<HTMLInputElement> = (e) => {\n    if (!filtered.length) return;\n    if (e.key === 'ArrowDown') { e.preventDefault(); setActive(i => Math.min(i + 1, filtered.length - 1)); }\n    else if (e.key === 'ArrowUp') { e.preventDefault(); setActive(i => Math.max(i - 1, 0)); }\n    else if (e.key === 'Enter') { e.preventDefault(); go(filtered[Math.max(0, active)].id); }\n  };\n\n  const startVoice = () => {\n    if (typeof window === 'undefined') return;\n    const SR: any = (window as any).SpeechRecognition || (window as any).webkitSpeechRecognition;\n    if (!SR) { alert('Voice recognition is not supported in this browser.'); return; }\n    const rec = new SR();\n    rec.lang = 'en-US';\n    rec.interimResults = false;\n    rec.maxAlternatives = 1;\n    setListening(true);\n    rec.onresult = (ev: any) => {\n      const t = ev?.results?.[0]?.[0]?.transcript || '';\n      const q = String(t).trim();\n      setQuery(q);\n      const match = findBestApp(q);\n      if (match) go(match.id);\n    };\n    rec.onerror = () => setListening(false);\n    rec.onend = () => setListening(false);\n    rec.start();\n  };\n\n  return (\n    <div className=\"flex-1 p-8\">\n      {/* Hero Section */}\n      <div className=\"text-center mb-12\">\n        <h1 className=\"text-4xl font-bold text-gray-900 mb-4\">\n          One Ashley Super Agent\n        </h1>\n        <p className=\"text-lg text-gray-700 mb-8\">\n          Ask anything, create anything\n        </p>\n\n        {/* Main Search Bar */}\n        <div className=\"max-w-2xl mx-auto mb-8\">\n          <div className=\"relative group\">\n            <input\n              type=\"text\"\n              placeholder=\"Ask anything, create anything\"\n              value={query}\n              onChange={(e) => { setQuery(e.target.value); setActive(0); }}\n              onKeyDown={onKeyDown}\n              className=\"w-full px-6 py-4 text-lg text-gray-900 placeholder-gray-500 bg-white/80 backdrop-blur border border-gray-200 rounded-2xl focus:outline-none focus:ring-2 focus:ring-[var(--ring)] focus:border-transparent shadow-sm hover:shadow-md focus:shadow-lg transition-all duration-300 placeholder:transition-opacity focus:placeholder-opacity-70\"\n            />\n            {/* Icons inside input */}\n            <div className=\"absolute right-4 top-1/2 transform -translate-y-1/2 flex items-center space-x-2\">\n              <button\n                type=\"button\"\n                onClick={startVoice}\n                aria-pressed={listening}\n                className={`p-2 rounded-lg transition-all duration-200 ${listening ? 'text-[var(--ring)] bg-gray-100 animate-pulse' : 'text-gray-400 hover:text-gray-600 hover:bg-gray-100 hover:rotate-6 active:scale-95'}`}\n              >\n                <MicrophoneIcon className=\"w-5 h-5\" />\n              </button>\n              <button className=\"p-2 rounded-lg text-gray-400 hover:text-gray-600 hover:bg-gray-100 transition-all duration-200 hover:rotate-3 active:scale-95\">\n                <PhotoIcon className=\"w-5 h-5\" />\n              </button>\n            </div>\n\n            {/* Suggestions dropdown */}\n            {filtered.length > 0 && (\n              <ul className=\"absolute left-0 right-0 mt-2 z-20 bg-white rounded-xl shadow-lg ring-1 ring-gray-200 overflow-hidden\">\n                {filtered.map((a, i) => (\n                  <li key={a.id}>\n                    <button\n                      type=\"button\"\n                      className={`w-full text-left px-4 py-3 flex items-center gap-3 hover:bg-gray-50 ${i === active ? 'bg-gray-50' : ''}`}\n                      onMouseDown={(e) => e.preventDefault()}\n                      onClick={() => go(a.id)}\n                    >\n                      <div className=\"w-7 h-7 rounded-md brand-soft brand-text flex items-center justify-center text-xs font-semibold\">\n                        {a.title.split(' ').map(w => w[0]).join('').slice(0,3).toUpperCase()}\n                      </div>\n                      <span className=\"text-sm text-gray-900\">{a.title}</span>\n                    </button>\n                  </li>\n                ))}\n              </ul>\n            )}\n          </div>\n        </div>\n\n\n      </div>\n\n      {/* AI Agents Grid (hidden) */}\n      <div className=\"max-w-6xl mx-auto\">\n        {SHOW_AI_GRID && (\n          <div className=\"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4 mb-8\">\n            {aiAgents.map((agent) => {\n              const IconComponent = agent.icon;\n              return (\n                <div\n                  key={agent.id}\n                  className=\"relative bg-white rounded-xl p-4 border border-gray-200 hover:border-gray-300 hover:shadow-md transition-all cursor-pointer group\"\n                >\n                  {agent.isNew && (\n                    <span className=\"absolute -top-2 -right-2 bg-green-500 text-white text-xs px-2 py-1 rounded-full\">\n                      NEW\n                    </span>\n                  )}\n                  {agent.isHot && (\n                    <span className=\"absolute -top-2 -right-2 bg-red-500 text-white text-xs px-2 py-1 rounded-full\">\n                      HOT\n                    </span>\n                  )}\n                  <div className=\"w-12 h-12 rounded-lg brand-soft brand-text flex items-center justify-center mb-3\">\n                    <IconComponent className=\"w-6 h-6\" />\n                  </div>\n                  <h3 className=\"font-medium text-gray-900 mb-1\">{agent.name}</h3>\n                  <p className=\"text-sm text-gray-500\">{agent.description}</p>\n                </div>\n              );\n            })}\n          </div>\n        )}\n\n        {/* For You Section - Feather fan on scroll */}\n        <div className=\"mt-2\">\n          <ForYouFeather />\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1029, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/NChinnappan/SourceAI/UI/shell-app/src/components/layout/SearchHistoryDrawer.tsx"],"sourcesContent":["\"use client\";\n\nimport React, { useEffect, useState } from \"react\";\nimport Link from \"next/link\";\nimport { useRouter } from \"next/navigation\";\nimport { readHistory, SearchHistoryItem, clearHistory } from \"@/utils/searchHistory\";\nimport { XMarkIcon, MagnifyingGlassIcon, ClockIcon } from \"@heroicons/react/24/outline\";\nimport catalogData from \"@/data/catalog.json\";\nimport { BuildingOfficeIcon, TruckIcon, CurrencyDollarIcon, UserGroupIcon, DocumentTextIcon, CubeIcon, ServerIcon, ChartBarIcon, Squares2X2Icon, SquaresPlusIcon } from \"@heroicons/react/24/outline\";\n\nconst ICONS: Record<string, React.ComponentType<{ className?: string }>> = {\n  BuildingOfficeIcon,\n  TruckIcon,\n  CurrencyDollarIcon,\n  UserGroupIcon,\n  DocumentTextIcon,\n  CubeIcon,\n  ServerIcon,\n  ChartBarIcon,\n  Squares2X2Icon,\n  SquaresPlusIcon,\n};\n\n// quick map of app id -> icon string\nconst CATALOG_ICON_BY_ID: Record<string, string | undefined> = Object.fromEntries(\n  (catalogData as any[]).map((c) => [c.id, c.icon])\n);\n\nexport default function SearchHistoryDrawer({ open, onClose }: { open: boolean; onClose: () => void }) {\n  const [items, setItems] = useState<SearchHistoryItem[]>([]);\n  const [filterQ, setFilterQ] = useState('');\n  const router = useRouter();\n\n  useEffect(() => {\n    if (!open) return;\n    setItems(readHistory());\n  }, [open]);\n\n  const go = (it: SearchHistoryItem) => {\n    const path = it.path || (it.id ? `/apps/${it.id}` : undefined);\n    if (path) router.push(path);\n    onClose();\n  };\n\n  const timeAgo = (ts: number) => {\n    const d = Date.now() - ts;\n    const m = Math.floor(d / 60000);\n    if (m < 1) return 'just now';\n    if (m < 60) return m + 'm';\n    const h = Math.floor(m / 60);\n    if (h < 24) return h + 'h';\n    const days = Math.floor(h / 24);\n    return days + 'd';\n  };\n\n  const display = (filterQ\n    ? items.filter(it => (it.title || '').toLowerCase().includes(filterQ.toLowerCase()) || it.query.toLowerCase().includes(filterQ.toLowerCase()))\n    : items\n  ).slice(0, 10);\n\n  if (!open) return null;\n\n\n  return (\n    <div className=\"fixed inset-0 z-50\">\n      {/* Backdrop */}\n      <button aria-label=\"Close\" onClick={onClose} className=\"absolute inset-0 bg-black/30\" />\n\n      {/* Drawer */}\n      <aside className=\"absolute left-0 top-0 h-full w-[320px] bg-white shadow-xl ring-1 ring-black/5 flex flex-col\">\n        <div className=\"flex items-center justify-between px-4 py-3 border-b border-gray-200\">\n          <div className=\"text-sm font-semibold text-gray-800\">Task List</div>\n          <div className=\"flex items-center gap-2\">\n            <button onClick={() => { clearHistory(); setItems([]); }} className=\"text-xs text-gray-500 hover:text-gray-700\">Clear</button>\n            <button onClick={onClose} className=\"p-1 rounded hover:bg-gray-100\">\n              <XMarkIcon className=\"w-5 h-5 text-gray-500\" />\n            </button>\n          </div>\n        </div>\n        {/* Search inside drawer */}\n        <div className=\"px-4 py-2 border-b border-gray-200\">\n          <div className=\"relative\">\n            <input\n              value={filterQ}\n              onChange={(e) => setFilterQ(e.target.value)}\n              placeholder=\"Search tasks\"\n              className=\"w-full pl-8 pr-3 py-2 text-sm bg-white/80 backdrop-blur border border-gray-200 rounded-2xl focus:outline-none focus:ring-2 focus:ring-[var(--ring)] shadow-sm hover:shadow-md focus:shadow-lg transition-all duration-300 placeholder:transition-opacity focus:placeholder-opacity-80\"\n            />\n            <MagnifyingGlassIcon className=\"w-4 h-4 text-gray-400 absolute left-2.5 top-1/2 -translate-y-1/2\" />\n          </div>\n        </div>\n\n\n        <div className=\"flex-1 overflow-auto py-2\">\n          {items.length === 0 ? (\n            <div className=\"px-4 py-6 text-sm text-gray-500\">No recent searches yet.</div>\n          ) : (\n            <>\n              <div className=\"px-4 text-[11px] uppercase tracking-wide text-gray-400 mb-2\">Today</div>\n              <ul className=\"px-2 space-y-1\">\n                {display.map((it, idx) => {\n                  const iconName = (it.id && CATALOG_ICON_BY_ID[it.id]) || undefined;\n                  const Icon = (iconName && ICONS[iconName]) || ClockIcon;\n                  return (\n                    <li key={idx}>\n\n                      <button onClick={() => go(it)} className=\"w-full flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-gray-100 text-left\">\n                        <span className=\"inline-flex items-center justify-center w-7 h-7 rounded-md bg-gray-100 text-gray-600\">\n                          <Icon className=\"w-4 h-4\" />\n                        </span>\n                        <span className=\"flex-1\">\n                          <div className=\"text-sm text-gray-900 line-clamp-1\">{it.title || it.query}</div>\n                          {it.title && (\n                            <div className=\"text-xs text-gray-500 line-clamp-1\">{it.query}</div>\n                          )}\n                        </span>\n                        <span className=\"text-[10px] text-gray-400\">×{it.count || 1} · {timeAgo(it.ts)}</span>\n                      </button>\n                    </li>\n                  );\n                })}\n              </ul>\n            </>\n          )}\n        </div>\n\n        <div className=\"px-4 py-3 border-t border-gray-200 text-xs text-gray-500\">\n          Tip: Click an item to repeat the same action.\n        </div>\n      </aside>\n    </div>\n  );\n}\n\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1354, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/NChinnappan/SourceAI/UI/shell-app/src/data/knowledge.ts"],"sourcesContent":["export type KnowledgeDoc = { id: string; title: string; text: string };\n\nexport const knowledgeDocs: KnowledgeDoc[] = [\n  {\n    id: 'catalog-overview',\n    title: 'Application Catalog Overview',\n    text:\n      'The shell provides access to core applications used at Ashley. Applications currently exposed in the catalog include Ashley Direct, Ashley Net, Supplier, HR, Payroll, Finance, Transportation, AS400, High Jump, and More Apps. You can ask the chatbot to list all apps or search by capability to quickly navigate.'\n  },\n  {\n    id: 'chatbot-commands',\n    title: 'Chatbot Commands and Capabilities',\n    text:\n      'The chatbot supports: listing all applications (e.g., \"list all apps\"), catalog search (e.g., \"search sales app\"), order status lookup (e.g., \"track order SO12345\"), and sample report generation (e.g., \"generate sales report csv 20 rows\"). It will ask follow-up questions to gather missing details (slot-filling).'\n  },\n  {\n    id: 'report-generation',\n    title: 'Report Generation (Sample Data)',\n    text:\n      'You can generate sample data reports for quick testing and demonstration. Supported report types include sales and inventory, with CSV or JSON outputs. The chatbot can also provide download options for CSV, JSON, Excel, Word, and PDF when enabled. Example: \"generate sales report json 15 rows\".'\n  },\n  {\n    id: 'search-history',\n    title: 'Search History and For You',\n    text:\n      'The shell UI includes a persisted search history with a left drawer interface. Recent searches are recorded locally and can be reviewed or filtered. The For You section highlights frequently used applications with vibrant icons and gradient cards.'\n  }\n];\n\n"],"names":[],"mappings":";;;;AAEO,MAAM,gBAAgC;IAC3C;QACE,IAAI;QACJ,OAAO;QACP,MACE;IACJ;IACA;QACE,IAAI;QACJ,OAAO;QACP,MACE;IACJ;IACA;QACE,IAAI;QACJ,OAAO;QACP,MACE;IACJ;IACA;QACE,IAAI;QACJ,OAAO;QACP,MACE;IACJ;CACD","debugId":null}},
    {"offset": {"line": 1387, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/NChinnappan/SourceAI/UI/shell-app/src/agents/orchestrator.ts"],"sourcesContent":["// Simple client-side orchestrator with pluggable agents and slot-filling\n\nimport catalogData from '@/data/catalog.json';\nimport { knowledgeDocs } from '@/data/knowledge';\n\nexport type AgentSession = {\n  agentId: string;\n  slotIndex: number;\n  slots: Record<string, string>;\n};\n\nexport type ReportAttachment = {\n  type: 'report';\n  name: string;\n  headers: string[];\n  rows: (string | number)[][];\n  format?: 'csv' | 'json';\n};\n\nexport type ProcessResult = {\n  replies: string[];\n  session: AgentSession | null;\n  attachment?: ReportAttachment;\n};\n\ntype ExecuteOutput = string | { message: string; attachment?: ReportAttachment };\n\ntype Agent = {\n  id: string;\n  name: string;\n  // Return a score 0..1 indicating how likely this agent matches the input\n  detect: (text: string) => number;\n  // Ordered slot keys to collect\n  slots: { key: string; question: string; optional?: boolean }[];\n  // Execute the task and return a final message or an object with attachment\n  execute: (slots: Record<string, string>) => Promise<ExecuteOutput> | ExecuteOutput;\n};\n\nfunction normalize(s: string) {\n  return s.toLowerCase().replace(/[^a-z0-9 ]/g, ' ').replace(/\\s+/g, ' ').trim();\n}\n\n// Catalog helpers\nfunction listAllCatalogTitles(limit?: number) {\n  const apps = catalogData as unknown as { id: string; title: string }[];\n  const arr = apps.map(a => ({ id: a.id, title: a.title }));\n  return typeof limit === 'number' ? arr.slice(0, Math.max(0, limit)) : arr;\n}\n\nfunction searchCatalog(query: string, topN = 5) {\n  const apps = catalogData as unknown as { id: string; title: string }[];\n  const q = normalize(query);\n  const scored = apps.map((a) => {\n    const t = normalize(a.title);\n    let score = 0;\n    if (!q) score = 0;\n    else if (t === q) score = 1.0;\n    else if (t.startsWith(q) || q.startsWith(t)) score = 0.8;\n    else if (t.includes(q) || q.includes(t)) score = 0.6;\n    else {\n      const qt = new Set(q.split(' '));\n      const tt = new Set(t.split(' '));\n      let overlap = 0;\n      qt.forEach((w) => {\n        if (tt.has(w)) overlap++;\n      });\n      if (overlap > 0) score = Math.min(0.4 + overlap * 0.05, 0.55);\n    }\n    return { ...a, score };\n  });\n  const sorted = scored.sort((a, b) => b.score - a.score).slice(0, topN);\n  return sorted.filter((x) => x.score >= 0.4);\n}\n\nfunction shouldListAll(text: string) {\n  const t = normalize(text);\n  if (!t) return false;\n  if (t === 'apps' || t === 'applications') return true;\n  const phrases = [\n    'list all apps', 'list apps', 'list applications', 'all applications', 'all apps',\n    'available applications', 'available apps', 'available application names', 'available app names',\n    'show all apps', 'show applications', 'show me all apps',\n    'app names', 'application names', 'list of apps', 'list of applications',\n    'apps list', 'application list', 'what apps are available', 'what applications are available',\n    'which apps are available', 'which applications are available',\n    'what apps do we have', 'which apps do we have',\n    'give available application names', 'give me app names', 'provide app names'\n  ];\n  if (phrases.some(p => t.includes(p))) return true;\n  // Heuristic: presence of an app word AND a list/ask word\n  const hasAppWord = ['app', 'apps', 'application', 'applications'].some(w => t.includes(w));\n  const hasListWord = ['list', 'available', 'names', 'name', 'show', 'display', 'all', 'what', 'which', 'give', 'provide'].some(w => t.includes(w));\n  return hasAppWord && hasListWord;\n}\n\nconst catalogAgent: Agent = {\n  id: 'catalog.search',\n  name: 'Catalog Search',\n  detect: (text) => {\n    const t = normalize(text);\n    if (!t) return 0;\n    if (shouldListAll(t)) return 0.95;\n    const keywords = ['search', 'find', 'open', 'launch', 'app', 'application', 'catalog', 'apps', 'applications', 'list', 'show'];\n    const hasKw = keywords.some((k) => t.includes(k));\n    const matches = searchCatalog(t, 1).length > 0;\n    if (hasKw && matches) return 0.9;\n    if (hasKw) return 0.6;\n    if (matches) return 0.45; // low score to avoid hijacking generic queries like \"tell me about ashley\"\n    return 0;\n  },\n  slots: [\n    { key: 'query', question: 'What app or capability are you looking for?' },\n    { key: 'topN', question: 'How many results would you like? (default 5, max 10)', optional: true },\n  ],\n  execute: (slots) => {\n    const q = slots.query || '';\n    const n = Math.min(Math.max(parseInt(slots.topN || '5', 10) || 5, 1), 10);\n    if (shouldListAll(q)) {\n      const all = listAllCatalogTitles();\n      const lines = all.map((r, i) => `${i + 1}. ${r.title} (/${r.id})`);\n      return `Available applications (${all.length}):\\n` + lines.join('\\n');\n    }\n    const results = searchCatalog(q, n);\n    if (!results.length) return `I couldn’t find results for “${q}”. Try a different phrase?`;\n    const lines = results.map((r, i) => `${i + 1}. ${r.title} (/${r.id})`);\n    return `Here are the top ${results.length} result(s) for “${q}”:\\n` + lines.join('\\n');\n  },\n};\n\nconst orderAgent: Agent = {\n  id: 'order.status',\n  name: 'Order Status',\n  detect: (text) => {\n    const t = normalize(text);\n    if (!t) return 0;\n    const kw = ['order', 'status', 'track', 'tracking'];\n    const has = kw.some((k) => t.includes(k));\n    const looksId = /\\b(ORD|SO|PO)[- ]?\\d{5,}\\b/.test(text);\n    return has ? (looksId ? 0.9 : 0.65) : 0;\n  },\n  slots: [\n    { key: 'orderId', question: 'What is the order ID?' },\n    { key: 'zip', question: 'Destination ZIP (optional)?', optional: true },\n  ],\n  execute: (slots) => {\n    const id = slots.orderId || 'unknown';\n    // Demo response\n    return `Order ${id} is in transit. ETA: 2–3 business days. Last scan: Little Rock, AR.\\nNeed detailed tracking link?`;\n  },\n};\n\n\n// --- Report generation helpers ---\n\nfunction generateReportDataset(reportType: string, rows = 10): { name: string; headers: string[]; rows: (string|number)[][] } {\n  const t = normalize(reportType);\n  const apps = (catalogData as unknown as { id: string; title: string }[]).map(a => a.title);\n  const now = Date.now();\n  const rand = (min: number, max: number) => Math.floor(min + Math.random() * (max - min + 1));\n\n  if (t.includes('sale')) {\n    const headers = ['date', 'application', 'orders', 'revenue_usd'];\n    const data: (string | number)[][] = Array.from({ length: rows }, (_, i) => {\n      const d = new Date(now - i * 86400000);\n      const app = apps[i % apps.length] || 'Ashley Direct';\n      const orders = rand(10, 180);\n      const revenue = orders * rand(50, 200);\n      return [d.toISOString().slice(0, 10), app, orders, revenue];\n    }).reverse();\n    return { name: 'sales', headers, rows: data };\n  }\n\n  if (t.includes('inventory') || t.includes('stock')) {\n    const headers = ['sku', 'item', 'qty_on_hand', 'reorder_point'];\n    const data: (string | number)[][] = Array.from({ length: rows }, (_, i) => {\n      const sku = `SKU-${1000 + i}`;\n      const item = `Item ${i + 1}`;\n      const qoh = rand(0, 500);\n      const rp = rand(50, 150);\n      return [sku, item, qoh, rp];\n    });\n    return { name: 'inventory', headers, rows: data };\n  }\n\n  // Default generic\n  const headers = ['id', 'name', 'value'];\n  const data: (string | number)[][] = Array.from({ length: rows }, (_, i) => [i + 1, `Row ${i + 1}`, rand(10, 999)]);\n  return { name: t || 'generic', headers, rows: data };\n}\n\n// --- RAG: simple TF-IDF over local knowledgeDocs ---\nfunction tokenize(s: string): string[] {\n  return normalize(s).split(' ').filter(Boolean);\n}\n\nconst ragIndex = (() => {\n  const docs = knowledgeDocs.map(d => ({ id: d.id, title: d.title, text: d.text, tokens: tokenize(d.text) }));\n  const df = new Map<string, number>();\n  const docVec = new Map<string, Map<string, number>>();\n  const docNorm = new Map<string, number>();\n  docs.forEach(d => {\n    const tf = new Map<string, number>();\n    d.tokens.forEach(t => tf.set(t, (tf.get(t) || 0) + 1));\n    tf.forEach((_, t) => df.set(t, (df.get(t) || 0) + 1));\n    docVec.set(d.id, tf);\n  });\n  const N = docs.length || 1;\n  const idf = new Map<string, number>();\n  df.forEach((dfv, t) => idf.set(t, Math.log(1 + N / (dfv || 1))));\n  docVec.forEach((tf, id) => {\n    let sum = 0;\n    tf.forEach((f, t) => {\n      const w = (1 + Math.log(f)) * (idf.get(t) || 0);\n      sum += w * w;\n    });\n    docNorm.set(id, Math.sqrt(sum) || 1);\n  });\n  return { docs, df, idf, docVec, docNorm };\n})();\n\nfunction ragSearch(query: string, k = 3): { id: string; title: string; score: number; snippet: string }[] {\n  const qTok = tokenize(query);\n  const qtf = new Map<string, number>();\n  qTok.forEach(t => qtf.set(t, (qtf.get(t) || 0) + 1));\n  let qsum = 0;\n  const qweights = new Map<string, number>();\n  qtf.forEach((f, t) => {\n    const w = (1 + Math.log(f)) * ((ragIndex.idf.get(t) || 0));\n    if (w > 0) { qweights.set(t, w); qsum += w * w; }\n  });\n  const qnorm = Math.sqrt(qsum) || 1;\n  const scored = ragIndex.docs.map(d => {\n    const tf = ragIndex.docVec.get(d.id)!;\n    let dot = 0;\n    qweights.forEach((qw, t) => {\n      const f = tf.get(t);\n      if (f) {\n        const dw = (1 + Math.log(f)) * ((ragIndex.idf.get(t) || 0));\n        dot += qw * dw;\n      }\n    });\n    const denom = qnorm * (ragIndex.docNorm.get(d.id) || 1);\n    const score = denom ? (dot / denom) : 0;\n    return { id: d.id, title: d.title, score, snippet: d.text.slice(0, 280) + (d.text.length > 280 ? '…' : '') };\n  }).sort((a, b) => b.score - a.score).slice(0, k).filter(r => r.score > 0.01);\n  return scored;\n}\n\nconst knowledgeAgent: Agent = {\n  id: 'knowledge.rag',\n  name: 'Knowledge Q&A',\n  detect: (text) => {\n    const t = normalize(text);\n    if (!t) return 0;\n    const qwords = ['what','how','where','when','why','which','who','tell','about','describe','overview','info','information','explain','guide','docs','document','documentation'];\n    const hasQ = qwords.some(w => t.includes(w)) || /\\b(what is|who is|tell me about|about)\\b/.test(t) || /\\?$/.test(text.trim());\n    return hasQ ? 0.8 : 0.5; // prefer over catalog when it's a general knowledge ask\n  },\n  slots: [\n    { key: 'query', question: 'What would you like to know?' },\n  ],\n  execute: async (slots) => {\n    const q = slots.query || '';\n    try {\n      const res = await fetch('/api/rag/query', { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ query: q, topK: 3, topSentences: 3 }) });\n      if (!res.ok) throw new Error('RAG query failed');\n      const data = await res.json();\n      const hits = (data?.hits || []) as { url:string; title?:string; text:string; score:number }[];\n      const answer = (data?.answer || '').toString();\n      if (answer && hits.length) {\n        const sources = hits.map((h, i) => `[${i + 1}] ${(h.title || h.url)}`).join('; ');\n        return `Answer:\\n${answer}\\n\\nSources: ${sources}`;\n      }\n      if (!hits.length) return `I couldn't find anything relevant for \"${q}\". Try rephrasing your question.`;\n      const lines = hits.map((h, i) => `${i + 1}. ${(h.title || h.url)} — ${h.text.slice(0, 280)}${h.text.length>280?'…':''}`);\n      const sources = hits.map((h, i) => `[${i + 1}] ${(h.title || h.url)}`).join('; ');\n      return `Here’s what I found:\\n${lines.join('\\n')}\\n\\nSources: ${sources}`;\n    } catch {\n      const hits = ragSearch(q, 3);\n      if (!hits.length) return `I couldn't find anything relevant for \"${q}\". Try rephrasing your question.`;\n      const lines = hits.map((h, i) => `${i + 1}. ${h.title} — ${h.snippet}`);\n      return `Here’s what I found:\\n${lines.join('\\n')}\\n\\nSources: ${hits.map((h, i) => '[' + (i + 1) + '] ' + h.title).join('; ')}`;\n    }\n  }\n};\n\n\nconst reportAgent: Agent = {\n  id: 'report.generate',\n  name: 'Report Generator',\n  detect: (text) => {\n    const t = normalize(text);\n    if (!t) return 0;\n    const kws = ['report', 'export', 'summary', 'csv', 'json'];\n    const score = kws.some(k => t.includes(k)) ? 0.85 : 0;\n    return score;\n  },\n  slots: [\n    { key: 'reportType', question: 'What report would you like? (e.g., sales by day, inventory, generic)' },\n    { key: 'range', question: 'What time range? (optional, e.g., last 30 days)', optional: true },\n    { key: 'format', question: 'CSV or JSON? (default CSV)', optional: true },\n    { key: 'rows', question: 'How many sample rows? (default 10)', optional: true },\n  ],\n  execute: (slots) => {\n    const type = (slots.reportType || 'generic').toString();\n    const n = Math.min(Math.max(parseInt((slots.rows || '10').toString(), 10) || 10, 1), 200);\n    const ds = generateReportDataset(type, n);\n    const message = `Generated ${ds.name} report with ${n} sample row(s). Choose a format to download.`;\n    return { message, attachment: { type: 'report', name: ds.name, headers: ds.headers, rows: ds.rows } };\n  },\n};\n\nconst agents: Agent[] = [reportAgent, catalogAgent, orderAgent, knowledgeAgent];\n\nfunction pickAgent(text: string): Agent | null {\n  const scored = agents\n    .map((a) => ({ a, s: a.detect(text) }))\n    .sort((x, y) => y.s - x.s);\n  if (!scored.length || scored[0].s < 0.5) return null;\n  return scored[0].a;\n}\n\nfunction advancePastOptional(agent: Agent, session: AgentSession) {\n  while (true) {\n    const s = agent.slots[session.slotIndex];\n    if (s && s.optional) { session.slotIndex += 1; continue; }\n    break;\n  }\n}\n\nfunction nextQuestion(agent: Agent, session: AgentSession): string | null {\n  const slot = agent.slots[session.slotIndex];\n  return slot ? slot.question : null;\n}\n\nexport async function processUserInput(\n  session: AgentSession | null,\n  userText: string\n): Promise<ProcessResult> {\n  const replies: string[] = [];\n  const text = userText.trim();\n  if (!text) return { replies, session };\n\n  if (!session) {\n    const agent = pickAgent(text);\n    if (!agent) {\n      replies.push(\n        \"I can help with: knowledge Q&A using RAG (ask questions about the shell and apps), generate a report with sample data (e.g., ‘generate sales report CSV 20 rows’), list available applications (e.g., ‘list all apps’), catalog search (e.g., ‘search sales app’), order status (e.g., ‘track order SO12345’).\"\n      );\n      return { replies, session: null };\n    }\n    // Start session and ask first question (unless user already supplied a clear value)\n    const newSession: AgentSession = { agentId: agent.id, slotIndex: 0, slots: {} };\n    // Heuristic: treat initial text as value for first slot if not a generic ask\n    if (agent.id === 'catalog.search') {\n      if (shouldListAll(text)) {\n        const all = listAllCatalogTitles();\n        const lines = all.map((r, i) => `${i + 1}. ${r.title} (/${r.id})`);\n        replies.push(`Available applications (${all.length}):\\n` + lines.join('\\n'));\n        return { replies, session: null };\n      }\n      newSession.slots.query = text;\n      newSession.slotIndex = 1; // move to next (topN is optional)\n      advancePastOptional(agent, newSession);\n    } else if (agent.id === 'order.status') {\n      const m = text.match(/\\b(ORD|SO|PO)[- ]?\\d{5,}\\b/);\n      if (m) {\n        newSession.slots.orderId = m[0].replace(' ', '-');\n        newSession.slotIndex = 1;\n      }\n    } else if (agent.id === 'report.generate') {\n      const lower = text.toLowerCase();\n      if (lower.includes('sales')) newSession.slots.reportType = 'sales';\n      else if (lower.includes('inventory') || lower.includes('stock')) newSession.slots.reportType = 'inventory';\n      else if (lower.includes('report')) newSession.slots.reportType = 'generic';\n      if (lower.includes('json')) newSession.slots.format = 'json';\n      if (lower.includes('csv')) newSession.slots.format = 'csv';\n      const mRows = lower.match(/(\\d+)\\s*(rows?|lines?)/);\n      if (mRows) newSession.slots.rows = mRows[1];\n      if (newSession.slots.reportType) newSession.slotIndex = 1;\n    } else if (agent.id === 'knowledge.rag') {\n      newSession.slots.query = text;\n      newSession.slotIndex = 1;\n    }\n    const ask = nextQuestion(agent, newSession);\n    if (ask) {\n      replies.push(ask);\n      return { replies, session: newSession };\n    }\n    // No more slots to ask -> execute immediately\n    const out = await agent.execute(newSession.slots);\n    if (typeof out === 'string') {\n      replies.push(out);\n      return { replies, session: null };\n    }\n    replies.push(out.message || 'Done.');\n    return { replies, session: null, attachment: out.attachment };\n  }\n\n  const agent = agents.find((a) => a.id === session.agentId)!;\n  // Accept value for current slot\n  const slotDef = agent.slots[session.slotIndex];\n  if (slotDef) {\n    session.slots[slotDef.key] = text;\n    session.slotIndex += 1;\n  }\n  // Skip optional blanks\n  while (true) {\n    const s = agent.slots[session.slotIndex];\n    if (s && s.optional) {\n      // If user typed '-', skip optional slot\n      if ((session.slots[s.key] || '') === '') {\n        // Keep as blank optional\n      }\n      session.slotIndex += 1;\n      continue;\n    }\n    break;\n  }\n\n  advancePastOptional(agent, session);\n  const next = nextQuestion(agent, session);\n  if (next) {\n    replies.push(next);\n    return { replies, session };\n  }\n\n  // Execute\n  const out = await agent.execute(session.slots);\n  if (typeof out === 'string') {\n    replies.push(out);\n    return { replies, session: null };\n  }\n  replies.push(out.message || 'Done.');\n  return { replies, session: null, attachment: out.attachment };\n}\n\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 2014, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/NChinnappan/SourceAI/UI/shell-app/src/components/chat/ChatDock.tsx"],"sourcesContent":["\"use client\";\n\nimport React, { useEffect, useRef, useState } from \"react\";\nimport {\n  ChatBubbleLeftRightIcon,\n  XMarkIcon,\n  PaperAirplaneIcon,\n  SparklesIcon,\n  MicrophoneIcon,\n  PaperClipIcon,\n} from \"@heroicons/react/24/outline\";\nimport { processUserInput, type AgentSession, type ReportAttachment } from '@/agents/orchestrator';\n\n\nexport type ChatMessage = {\n  id: string;\n  role: \"user\" | \"assistant\";\n  content: string;\n  ts: number;\n  attachment?: ReportAttachment;\n};\n\nconst STORAGE_KEY = \"chatdock_messages_v1\";\n\nfunction usePersistentMessages() {\n  const [messages, setMessages] = useState<ChatMessage[]>([]);\n  useEffect(() => {\n    if (typeof window === \"undefined\") return;\n    try {\n      const raw = localStorage.getItem(STORAGE_KEY);\n      if (raw) setMessages(JSON.parse(raw));\n    } catch {}\n  }, []);\n  useEffect(() => {\n    if (typeof window === \"undefined\") return;\n    try {\n      localStorage.setItem(STORAGE_KEY, JSON.stringify(messages));\n    } catch {}\n  }, [messages]);\n  return [messages, setMessages] as const;\n}\n\nexport default function ChatDock() {\n  const [open, setOpen] = useState(false);\n  const [session, setSession] = useState<AgentSession | null>(null);\n\n  const [input, setInput] = useState(\"\");\n  const [messages, setMessages] = usePersistentMessages();\n  const listRef = useRef<HTMLDivElement>(null);\n\n  // RAG ingest UI state\n  const [ragDir, setRagDir] = useState(\"\");\n  const [ragBusy, setRagBusy] = useState(false);\n  const [ragMsg, setRagMsg] = useState<string | null>(null);\n  type IngestResult = { url: string; chunks?: number; error?: string };\n  type IngestResponse = { ok: boolean; results: IngestResult[]; error?: string };\n  const ingestDir = async () => {\n    const dir = ragDir.trim();\n    if (!dir) { setRagMsg('Enter a folder path'); return; }\n    setRagBusy(true);\n    setRagMsg(null);\n    try {\n      const res = await fetch('/api/rag/ingest', { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ dir }) });\n      const data: IngestResponse = await res.json();\n      if (!res.ok || !data.ok) throw new Error(data.error || 'Failed to ingest');\n      const okCount = data.results.filter(r => !r.error).length;\n      const totalChunks = data.results.reduce((acc, r) => acc + (r.chunks || 0), 0);\n      setRagMsg(`Indexed ${okCount} file(s), ${totalChunks} chunk(s).`);\n    } catch (e) {\n      setRagMsg(e instanceof Error ? e.message : String(e));\n    } finally {\n      setRagBusy(false);\n    }\n  };\n\n  // Download helpers for report attachments\n  const toCSV = (headers: string[], rows: (string|number)[][]) => {\n    const esc = (v: string|number) => {\n      const s = String(v);\n      return /[\",\\n]/.test(s) ? '\"' + s.replace(/\"/g, '\"\"') + '\"' : s;\n    };\n    return [headers.join(','), ...rows.map(r => r.map(esc).join(','))].join('\\n');\n  };\n  const triggerDownload = (filename: string, mime: string, data: Blob | string | ArrayBuffer) => {\n    let blob: Blob;\n    if (data instanceof Blob) {\n      blob = data;\n    } else if (typeof data === 'string') {\n      blob = new Blob([data], { type: mime });\n    } else {\n      // ArrayBuffer\n      blob = new Blob([new Uint8Array(data)], { type: mime });\n    }\n    const url = URL.createObjectURL(blob);\n    const a = document.createElement('a');\n    a.href = url;\n    a.download = filename;\n    document.body.appendChild(a);\n    a.click();\n    a.remove();\n    URL.revokeObjectURL(url);\n  };\n  const downloadCSV = (att: ReportAttachment) => {\n    const csv = toCSV(att.headers, att.rows);\n    triggerDownload(`${att.name}.csv`, 'text/csv;charset=utf-8', csv);\n  };\n  const downloadJSON = (att: ReportAttachment) => {\n    const objs = att.rows.map(row => Object.fromEntries(att.headers.map((h, i) => [h, row[i] ?? null])));\n    const json = JSON.stringify({ report: att.name, rows: objs }, null, 2);\n    triggerDownload(`${att.name}.json`, 'application/json', json);\n  };\n  const downloadXLSX = async (att: ReportAttachment) => {\n    try {\n      const XLSX = await import('xlsx');\n      const wb = XLSX.utils.book_new();\n      const ws = XLSX.utils.aoa_to_sheet([att.headers, ...att.rows]);\n      XLSX.utils.book_append_sheet(wb, ws, 'Report');\n      const wbout = XLSX.write(wb, { bookType: 'xlsx', type: 'array' });\n      triggerDownload(`${att.name}.xlsx`, 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet', wbout);\n    } catch {\n      alert('Excel export requires the \"xlsx\" package. I can install it if you allow.');\n    }\n  };\n  const downloadDOCX = async (att: ReportAttachment) => {\n    try {\n      const docx = await import('docx');\n      const { Document, Packer, Paragraph, Table, TableRow, TableCell, WidthType } = docx;\n      const headerRow = new TableRow({ children: att.headers.map((h) => new TableCell({ children: [new Paragraph(String(h))] })) });\n      const bodyRows = att.rows.map((r) => new TableRow({ children: r.map((c) => new TableCell({ children: [new Paragraph(String(c))] })) }));\n      const table = new Table({ width: { size: 100, type: WidthType.PERCENTAGE }, rows: [headerRow, ...bodyRows] });\n      const doc = new Document({ sections: [{ properties: {}, children: [new Paragraph(`${att.name} report`), table] }] });\n      const blob = await Packer.toBlob(doc);\n      triggerDownload(`${att.name}.docx`, 'application/vnd.openxmlformats-officedocument.wordprocessingml.document', blob);\n    } catch {\n      alert('Word export requires the \"docx\" package. I can install it if you allow.');\n    }\n  };\n  const downloadPDF = async (att: ReportAttachment) => {\n    try {\n      const jsPDFMod = await import('jspdf');\n      const JsPDF = jsPDFMod.default;\n      try { await import('jspdf-autotable'); } catch {}\n      const doc = new JsPDF();\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      if ((doc as any).autoTable) {\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        (doc as any).autoTable({ head: [att.headers], body: att.rows });\n      } else {\n        doc.text(`${att.name} report`, 14, 16);\n        let y = 26;\n        const text = toCSV(att.headers, att.rows);\n        text.split('\\n').slice(0, 50).forEach((line) => { doc.text(line, 14, y); y += 6; });\n      }\n      doc.save(`${att.name}.pdf`);\n    } catch {\n      alert('PDF export requires \"jspdf\" (and optionally \"jspdf-autotable\"). I can install them if you allow.');\n    }\n  };\n\n\n  useEffect(() => {\n    if (!open) return;\n    const el = listRef.current;\n    if (el) el.scrollTop = el.scrollHeight;\n  }, [open, messages.length]);\n\n  const send = async () => {\n    const text = input.trim();\n    if (!text) return;\n    const user: ChatMessage = { id: crypto.randomUUID(), role: \"user\", content: text, ts: Date.now() };\n    const typing: ChatMessage = { id: crypto.randomUUID(), role: \"assistant\", content: \"…\", ts: Date.now() };\n    setMessages((prev) => [...prev, user, typing]);\n    setInput(\"\");\n\n    // Agentic processing with slot-filling (async)\n    const result = await processUserInput(session, text);\n    setSession(result.session);\n    const reply = (result.replies && result.replies.length) ? result.replies.join(\"\\n\") : \"Okay.\";\n\n    setTimeout(() => {\n      setMessages((prev) => prev.map((m) => (m === typing ? { ...m, content: reply, attachment: result.attachment } : m)));\n    }, 500);\n  };\n\n  return (\n    <div className=\"pointer-events-none\">\n      {/* Floating toggle button */}\n      <button\n        aria-label=\"Open chatbot\"\n        onClick={() => setOpen((v) => !v)}\n        className=\"pointer-events-auto fixed bottom-6 right-6 z-50 inline-flex items-center justify-center w-14 h-14 rounded-full shadow-lg bg-[var(--primary)] text-white hover:shadow-xl active:scale-95 transition-all\"\n      >\n        {open ? <XMarkIcon className=\"w-6 h-6\" /> : <ChatBubbleLeftRightIcon className=\"w-6 h-6\" />}\n      </button>\n\n      {/* Panel */}\n      <div\n        className={`pointer-events-auto fixed bottom-24 right-6 z-50 w-[360px] sm:w-[400px] ${\n          open ? \"opacity-100 translate-y-0\" : \"opacity-0 translate-y-4 pointer-events-none\"\n        } transition-all duration-300`}\n      >\n        <div className=\"rounded-2xl overflow-hidden shadow-2xl ring-1 ring-black/10 bg-white/90 backdrop-blur\">\n          {/* Header */}\n          <div className=\"flex items-center justify-between px-4 py-3 border-b border-gray-200\">\n            <div className=\"flex items-center gap-2\">\n              <div className=\"w-7 h-7 rounded-lg brand-soft brand-text flex items-center justify-center\">\n                <SparklesIcon className=\"w-4 h-4\" />\n              </div>\n              <div className=\"text-sm font-semibold text-gray-900\">Ashley AI</div>\n            </div>\n            <button onClick={() => setOpen(false)} className=\"p-1 rounded hover:bg-gray-100\">\n              <XMarkIcon className=\"w-5 h-5 text-gray-500\" />\n            </button>\n          </div>\n\n          {/* RAG ingest panel */}\n          <div className=\"px-4 py-2 border-b border-gray-200 bg-gray-50/60\">\n            <div className=\"text-[11px] text-gray-600 mb-1\">RAG: Ingest from folder</div>\n            <div className=\"flex gap-2\">\n              <input\n                value={ragDir}\n                onChange={(e) => setRagDir(e.target.value)}\n                placeholder=\"C:\\\\Users\\\\NChinnappan\\\\Downloads\\\\data feed\"\n                className=\"flex-1 bg-white/90 border border-gray-200 rounded-lg px-2 py-1 text-xs outline-none focus:ring-2 focus:ring-[var(--ring)]\"\n              />\n              <button\n                onClick={ingestDir}\n                disabled={ragBusy}\n                className=\"px-2 py-1 text-xs rounded-md bg-[var(--primary)] text-white disabled:opacity-50\"\n              >\n                {ragBusy ? 'Indexing…' : 'Index'}\n              </button>\n            </div>\n            {ragMsg && <div className=\"mt-1 text-[11px] text-gray-600\">{ragMsg}</div>}\n          </div>\n\n          {/* Messages */}\n          <div ref={listRef} className=\"max-h-[50vh] overflow-y-auto px-3 py-3 space-y-3\">\n            {messages.length === 0 ? (\n              <div className=\"text-xs text-gray-500 px-2 py-6 text-center\">\n                Ask anything. This is a UI shell; responses are simulated.\n              </div>\n            ) : (\n              messages.map((m) => (\n                <div key={m.id} className={`flex ${m.role === \"user\" ? \"justify-end\" : \"justify-start\"}`}>\n                  <div\n                    className={`px-3 py-2 text-sm rounded-2xl max-w-[80%] shadow-sm transition-all ${\n                      m.role === \"user\"\n                        ? \"bg-[var(--primary)] text-white rounded-br-sm\"\n                        : \"bg-gray-100 text-gray-800 rounded-bl-sm\"\n                    }`}\n                  >\n                    <div>{m.content}</div>\n                    {m.role === 'assistant' && m.attachment?.type === 'report' && (\n                      <div className=\"mt-2 flex flex-wrap gap-2\">\n                        <button onClick={() => downloadCSV(m.attachment!)} className=\"px-2 py-1 text-xs rounded-md bg-white/70 hover:bg-white text-gray-800 border border-gray-200 shadow-sm\">CSV</button>\n                        <button onClick={() => downloadJSON(m.attachment!)} className=\"px-2 py-1 text-xs rounded-md bg-white/70 hover:bg-white text-gray-800 border border-gray-200 shadow-sm\">JSON</button>\n                        <button onClick={() => downloadXLSX(m.attachment!)} className=\"px-2 py-1 text-xs rounded-md bg-white/70 hover:bg-white text-gray-800 border border-gray-200 shadow-sm\">Excel</button>\n                        <button onClick={() => downloadDOCX(m.attachment!)} className=\"px-2 py-1 text-xs rounded-md bg-white/70 hover:bg-white text-gray-800 border border-gray-200 shadow-sm\">Word</button>\n                        <button onClick={() => downloadPDF(m.attachment!)} className=\"px-2 py-1 text-xs rounded-md bg-white/70 hover:bg-white text-gray-800 border border-gray-200 shadow-sm\">PDF</button>\n                      </div>\n                    )}\n                  </div>\n                </div>\n              ))\n            )}\n          </div>\n\n          {/* Composer */}\n          <div className=\"px-3 pb-3\">\n            <div className=\"relative flex items-center gap-2 bg-white/80 backdrop-blur border border-gray-200 rounded-2xl px-3 py-2 shadow-sm focus-within:ring-2 focus-within:ring-[var(--ring)] transition-all\">\n              <button className=\"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-all\" title=\"Attach\">\n                <PaperClipIcon className=\"w-5 h-5\" />\n              </button>\n              <input\n                value={input}\n                onChange={(e) => setInput(e.target.value)}\n                onKeyDown={(e) => { if (e.key === 'Enter') { e.preventDefault(); send(); } }}\n                placeholder=\"Message Ashley AI\"\n                className=\"flex-1 bg-transparent outline-none text-sm placeholder-gray-500\"\n              />\n              <button className=\"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-all\" title=\"Voice\">\n                <MicrophoneIcon className=\"w-5 h-5\" />\n              </button>\n              <button\n                onClick={send}\n                className=\"inline-flex items-center gap-1 bg-[var(--primary)] text-white text-sm px-3 py-1.5 rounded-xl shadow hover:shadow-md active:scale-95 transition-all\"\n                title=\"Send\"\n              >\n                <PaperAirplaneIcon className=\"w-4 h-4\" />\n                Send\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 2661, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/NChinnappan/SourceAI/UI/shell-app/src/components/layout/ShellLayout.tsx"],"sourcesContent":["'use client';\n\nimport React, { useState } from 'react';\nimport { Sidebar } from './Sidebar';\nimport { Header } from './Header';\nimport { MainContent } from './MainContent';\nimport dynamic from 'next/dynamic';\nimport SearchHistoryDrawer from './SearchHistoryDrawer';\nimport ChatDock from '../chat/ChatDock';\nimport { MegaphoneIcon, EnvelopeIcon, UserGroupIcon, ChatBubbleLeftRightIcon, Squares2X2Icon, TruckIcon, GlobeAmericasIcon } from '@heroicons/react/24/outline';\n\nconst NotificationTray = dynamic(() => import('./NotificationTray'), { ssr: false });\n\ninterface ShellLayoutProps {\n  children?: React.ReactNode;\n  initialSelectedDepartment?: string | null;\n}\n\nexport function ShellLayout({ children, initialSelectedDepartment = null }: ShellLayoutProps) {\n  const [selectedDepartment, setSelectedDepartment] = useState<string | null>(initialSelectedDepartment);\n  const [historyOpen, setHistoryOpen] = useState(false);\n\n  return (\n    <div className=\"flex h-screen bg-gray-50\">\n      {/* Sidebar */}\n      <Sidebar\n        selectedDepartment={selectedDepartment}\n        onDepartmentSelect={setSelectedDepartment}\n        onPlusClick={() => setHistoryOpen(true)}\n      />\n\n      {/* Main Content Area */}\n      <div className=\"flex-1 flex flex-col overflow-hidden\">\n        <Header />\n        <main className=\"relative flex-1 overflow-hidden\">\n          <div className=\"h-full flex\">\n            {/* Primary content area */}\n            <div className=\"flex-1 overflow-auto\">\n              {selectedDepartment ? (\n                <div className=\"h-full\">\n                  {/* This is where remote microfrontends will be loaded */}\n                  <div className=\"p-6\">\n                    <h2 className=\"text-2xl font-semibold mb-4\">\n                      {selectedDepartment.charAt(0).toUpperCase() + selectedDepartment.slice(1)} Department\n                    </h2>\n                    <p className=\"text-gray-600\">\n                      Loading {selectedDepartment} application...\n                    </p>\n                  </div>\n                </div>\n              ) : (\n                <MainContent />\n              )}\n              {children}\n            </div>\n\n            {/* Right panel after header */}\n            <aside className=\"hidden lg:block w-72 shrink-0 border-l border-gray-200 bg-white/60 backdrop-blur supports-[backdrop-filter]:bg-white/50 h-full overflow-y-auto\">\n              <div className=\"pt-8 px-3 pb-24 space-y-3\">\n                <div className=\"relative\">\n                  {/* Banner style header */}\n                  <div className=\"flex items-center rounded-lg rounded-b-none shadow-sm px-4 py-3\" style={{ backgroundColor: 'var(--primary)' }}>\n                    <span className=\"text-white text-sm font-semibold\">Notifications</span>\n                  </div>\n                  {/* Small notch */}\n                  <div className=\"absolute -top-2 right-8 w-4 h-4 rotate-45\" style={{ backgroundColor: 'var(--primary)', borderRadius: 2 }} />\n                </div>\n                <NotificationTray embedded controls showClose />\n\n                {/* Announcements */}\n                <section className=\"mt-4 bg-white rounded-xl shadow-sm ring-1 ring-gray-200/70 p-4\">\n                  <div className=\"flex items-center gap-2\">\n                    <div className=\"h-7 w-7 rounded-full brand-soft brand-text flex items-center justify-center\">\n                      <MegaphoneIcon className=\"w-4 h-4\" />\n                    </div>\n                    <h3 className=\"text-sm font-semibold\" style={{ color: '#0f172a' }}>Announcements</h3>\n                  </div>\n                  <div className=\"mt-3 p-3 rounded-lg brand-soft\" style={{ color: '#0f172a' }}>\n                    <div className=\"text-sm font-semibold\">System Maintenance Scheduled</div>\n                    <div className=\"text-xs mt-1\" style={{ opacity: 0.8 }}>This Sunday from 2 AM to 4 AM.</div>\n                  </div>\n                </section>\n\n                {/* Quick Links */}\n                <section className=\"mt-4 bg-white rounded-xl shadow-sm ring-1 ring-gray-200/70 p-4\">\n                  <h3 className=\"text-sm font-semibold mb-3\" style={{ color: '#0f172a' }}>Quick Links</h3>\n                  <div className=\"grid grid-cols-2 gap-3\">\n                    <a href=\"#\" className=\"flex items-center gap-2 rounded-lg brand-soft px-3 py-2 hover:opacity-90\">\n                      <EnvelopeIcon className=\"w-5 h-5 brand-text\" />\n                      <span className=\"text-sm\" style={{ color: '#0f172a' }}>Outlook</span>\n                    </a>\n                    <a href=\"#\" className=\"flex items-center gap-2 rounded-lg brand-soft px-3 py-2 hover:opacity-90\">\n                      <UserGroupIcon className=\"w-5 h-5 brand-text\" />\n                      <span className=\"text-sm\" style={{ color: '#0f172a' }}>Teams</span>\n                    </a>\n                    <a href=\"#\" className=\"flex items-center gap-2 rounded-lg brand-soft px-3 py-2 hover:opacity-90\">\n                      <ChatBubbleLeftRightIcon className=\"w-5 h-5 brand-text\" />\n                      <span className=\"text-sm\" style={{ color: '#0f172a' }}>Slack</span>\n                    </a>\n                    <a href=\"#\" className=\"flex items-center gap-2 rounded-lg brand-soft px-3 py-2 hover:opacity-90\">\n                      <Squares2X2Icon className=\"w-5 h-5 brand-text\" />\n                      <span className=\"text-sm\" style={{ color: '#0f172a' }}>Trello</span>\n                    </a>\n                  </div>\n                </section>\n\n                {/* Sales (month-wise) */}\n                <section className=\"mt-4 bg-white rounded-xl shadow-sm ring-1 ring-gray-200/70 p-4\">\n                  <h3 className=\"text-sm font-semibold mb-3\" style={{ color: '#0f172a' }}>Sales (last 12 months)</h3>\n                  {(() => {\n                    const data = [\n                      { m: 'J', v: 120 }, { m: 'F', v: 160 }, { m: 'M', v: 180 }, { m: 'A', v: 140 },\n                      { m: 'M', v: 200 }, { m: 'J', v: 230 }, { m: 'J', v: 190 }, { m: 'A', v: 210 },\n                      { m: 'S', v: 260 }, { m: 'O', v: 240 }, { m: 'N', v: 220 }, { m: 'D', v: 280 },\n                    ];\n                    const max = Math.max(...data.map(d => d.v)) || 1;\n                    return (\n                      <div>\n                        <div className=\"h-24 flex items-end gap-1\">\n                          {data.map((d, i) => (\n                            <div key={i} className=\"flex-1 flex flex-col items-center\">\n                              <div className=\"w-full rounded-t-md\" style={{ height: `${Math.max(6, Math.round((d.v / max) * 90))}px`, background: 'var(--primary)', opacity: 0.8 }} />\n                              <div className=\"text-[10px] text-gray-500 mt-1\">{d.m}</div>\n                            </div>\n                          ))}\n                        </div>\n                        <div className=\"mt-2 text-[11px] text-gray-600\">Total YTD: <span className=\"font-semibold text-gray-800\">${[...data].reduce((a, b) => a + b.v, 0).toLocaleString()}</span></div>\n                      </div>\n                    );\n                  })()}\n                </section>\n\n                {/* Logistics status */}\n                <section className=\"mt-4 bg-white rounded-xl shadow-sm ring-1 ring-gray-200/70 p-4\">\n                  <h3 className=\"text-sm font-semibold mb-3\" style={{ color: '#0f172a' }}>Logistics</h3>\n                  <div className=\"flex items-center justify-between text-sm\">\n                    <div className=\"flex items-center gap-2\">\n                      <span className=\"inline-flex items-center justify-center w-6 h-6 rounded-md brand-soft\">\n                        <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" className=\"w-4 h-4 brand-text\"><path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"1.5\" d=\"M3 7h11v10H3zM14 10h4.586a2 2 0 0 1 1.414.586l.414.414A2 2 0 0 1 21 12.414V17h-7v-7zM5 19a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm12 0a1 1 0 1 0 0-2 1 1 0 0 0 0 2z\"/></svg>\n                      </span>\n                      <span>Trucks in transit</span>\n                    </div>\n                    <div className=\"font-semibold\" style={{ color: '#0f172a' }}>18</div>\n                  </div>\n                  <div className=\"mt-3 text-[12px] text-gray-700\">Container ships</div>\n                  <div className=\"mt-1 flex flex-wrap gap-2\">\n                    <span className=\"inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-[11px] bg-blue-50 text-blue-700 border border-blue-200\">\n                      <span className=\"w-2 h-2 rounded-full bg-blue-500\" /> On water: 3\n                    </span>\n                    <span className=\"inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-[11px] bg-emerald-50 text-emerald-700 border border-emerald-200\">\n                      <span className=\"w-2 h-2 rounded-full bg-emerald-500\" /> At port: 1\n                    </span>\n                    <span className=\"inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-[11px] bg-amber-50 text-amber-700 border border-amber-200\">\n                      <span className=\"w-2 h-2 rounded-full bg-amber-500\" /> Customs: 1\n                    </span>\n                    <span className=\"inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-[11px] bg-rose-50 text-rose-700 border border-rose-200\">\n                      <span className=\"w-2 h-2 rounded-full bg-rose-500\" /> Delayed: 1\n                    </span>\n                  </div>\n                </section>\n\n              </div>\n            </aside>\n          </div>\n        </main>\n        <SearchHistoryDrawer open={historyOpen} onClose={() => setHistoryOpen(false)} />\n        <ChatDock />\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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","debugId":null}}]
}